# üîê –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤

**–î–∞—Ç–∞:** 2025-11-22
**–°—Ç–∞—Ç—É—Å:** ‚úÖ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç!

## ‚úÖ –£—Å–ø–µ—à–Ω–æ –≤—ã–ø—É—â–µ–Ω–Ω—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã:

1. ‚úÖ **api.volzhck.ru** - READY
2. ‚úÖ **modernissimo.volzhck.ru** - READY *(–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ, —Ä–∞–±–æ—Ç–∞–µ—Ç!)*
3. ‚úÖ **sushi-era.volzhck.ru** - READY
4. ‚úÖ **november.volzhck.ru** - READY
5. ‚è≥ **dodo.volzhck.ru** - –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ (—Ç—Ä–µ–±—É–µ—Ç—Å—è –æ–±–Ω–æ–≤–∏—Ç—å DNS)
6. ‚è≥ **volzhck.ru** - –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ (—Ç—Ä–µ–±—É–µ—Ç—Å—è –æ–±–Ω–æ–≤–∏—Ç—å DNS)

## üéØ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ:

### –ü—Ä–æ–±–ª–µ–º–∞:
Let's Encrypt **–Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç wildcard —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã** (`*.volzhck.ru`) —á–µ—Ä–µ–∑ HTTP-01 challenge.

### –†–µ—à–µ–Ω–∏–µ:
–°–æ–∑–¥–∞–ª–∏ **–æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–¥–¥–æ–º–µ–Ω–∞** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º HTTP-01 challenge.

## üìã DNS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

### –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ IP –∞–¥—Ä–µ—Å–∞ –¥–ª—è A-–∑–∞–ø–∏—Å–µ–π:

```
Timeweb Cloud Kubernetes Ingress IP:
- 82.97.240.172
- 31.130.147.150
```

### –ù–∞—Å—Ç—Ä–æ–π—Ç–µ A-–∑–∞–ø–∏—Å–∏ –≤ DNS:

```
api.volzhck.ru         A  89.223.127.140  (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ ‚úÖ)
modernissimo.volzhck.ru A  89.223.127.140  (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ ‚úÖ)
sushi-era.volzhck.ru    A  89.223.127.140  (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ ‚úÖ)
november.volzhck.ru     A  89.223.127.140  (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ ‚úÖ)
dodo.volzhck.ru         A  89.223.127.140  (—Ç—Ä–µ–±—É–µ—Ç—Å—è –æ–±–Ω–æ–≤–∏—Ç—å!)
volzhck.ru              A  89.223.127.140  (—Ç—Ä–µ–±—É–µ—Ç—Å—è –æ–±–Ω–æ–≤–∏—Ç—å!)
```

**–¢–µ–∫—É—â–∏–µ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∑–∞–ø–∏—Å–∏:**
- `dodo.volzhck.ru` ‚Üí 178.253.43.111 ‚ùå
- `volzhck.ru` ‚Üí 178.253.43.111 ‚ùå

## üîß –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤:

cert-manager –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –∑–∞ 30 –¥–Ω–µ–π –¥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è.

**–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
kubectl get certificate -n klassifikator

# –î–µ—Ç–∞–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
kubectl describe certificate <name> -n klassifikator

# –ü—Ä–æ–≤–µ—Ä–∫–∞ challenges (–ø—Ä–æ—Ü–µ—Å—Å –≤—ã–ø—É—Å–∫–∞)
kubectl get challenges -n klassifikator
```

## üÜï –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ª–µ–Ω–¥–∏–Ω–≥–∞:

–ö–æ–≥–¥–∞ —Å–æ–∑–¥–∞–µ—Ç–µ –Ω–æ–≤—ã–π –ª–µ–Ω–¥–∏–Ω–≥ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `newshop.volzhck.ru`):

1. **–û–±–Ω–æ–≤–∏—Ç–µ Ingress** - –¥–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–π –±–ª–æ–∫:

```yaml
tls:
- hosts:
  - newshop.volzhck.ru
  secretName: newshop-volzhck-ru-tls
# ...
rules:
- host: newshop.volzhck.ru
  http:
    paths:
    - path: /
      pathType: Prefix
      backend:
        service:
          name: template-service
          port:
            number: 8083
```

2. **–ü—Ä–∏–º–µ–Ω–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
```bash
kubectl apply -f k8s/base/ingress-with-individual-certs.yaml
```

3. **–î–æ–∂–¥–∏—Ç–µ—Å—å –≤—ã–ø—É—Å–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ (1-2 –º–∏–Ω—É—Ç—ã):**
```bash
kubectl get certificate -n klassifikator -w
```

4. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ DNS A-–∑–∞–ø–∏—Å—å:**
```
newshop.volzhck.ru  A  89.223.127.140
```

## ‚ö° –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (Wildcard —á–µ—Ä–µ–∑ DNS-01):

–ï—Å–ª–∏ –≤–∞–º –Ω—É–∂–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–ø—É—Å–∫–∞—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –¥–ª—è **–≤—Å–µ—Ö** –Ω–æ–≤—ã—Ö –ø–æ–¥–¥–æ–º–µ–Ω–æ–≤ –±–µ–∑ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è Ingress:

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- API –¥–æ—Å—Ç—É–ø –∫ –≤–∞—à–µ–º—É DNS –ø—Ä–æ–≤–∞–π–¥–µ—Ä—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, Cloudflare, Route53, etc.)
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ DNS-01 challenge –≤ cert-manager

### –ü—Ä–∏–º–µ—Ä –¥–ª—è Cloudflare:

1. –ü–æ–ª—É—á–∏—Ç–µ API Token –≤ Cloudflare
2. –°–æ–∑–¥–∞–π—Ç–µ Secret:
```bash
kubectl create secret generic cloudflare-api-token \
  --from-literal=api-token=YOUR_TOKEN \
  -n cert-manager
```

3. –û–±–Ω–æ–≤–∏—Ç–µ ClusterIssuer:
```yaml
apiVersion: cert-manager.io/v1
kind: ClusterIssuer
metadata:
  name: letsencrypt-prod-dns
spec:
  acme:
    server: https://acme-v02.api.letsencrypt.org/directory
    email: your-email@example.com
    privateKeySecretRef:
      name: letsencrypt-prod-dns
    solvers:
    - dns01:
        cloudflare:
          apiTokenSecretRef:
            name: cloudflare-api-token
            key: api-token
```

4. –û–±–Ω–æ–≤–∏—Ç–µ Ingress –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è wildcard:
```yaml
tls:
- hosts:
  - "*.volzhck.ru"
  secretName: wildcard-volzhck-ru-tls
```

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã SSL:

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ curl
curl -I https://modernissimo.volzhck.ru

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
openssl s_client -connect modernissimo.volzhck.ru:443 -servername modernissimo.volzhck.ru < /dev/null 2>&1 | grep -A 5 "Certificate chain"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä
# –û—Ç–∫—Ä–æ–π—Ç–µ: https://modernissimo.volzhck.ru
# –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∑–∞–º–æ—á–µ–∫ ‚Üí –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–µ–ª–µ–Ω—ã–π, —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –æ—Ç Let's Encrypt
```

## ‚úÖ –ò—Ç–æ–≥:

**SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã —É—Å–ø–µ—à–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –¥–ª—è 4 –ª–µ–Ω–¥–∏–Ω–≥–æ–≤!**
- modernissimo.volzhck.ru ‚úÖ
- sushi-era.volzhck.ru ‚úÖ  
- november.volzhck.ru ‚úÖ
- api.volzhck.ru ‚úÖ

**–û—Å—Ç–∞–ª–æ—Å—å –æ–±–Ω–æ–≤–∏—Ç—å DNS –¥–ª—è:**
- dodo.volzhck.ru (IP: 178.253.43.111 ‚Üí 89.223.127.140)
- volzhck.ru (IP: 178.253.43.111 ‚Üí 89.223.127.140)

–ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è DNS —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –¥–ª—è —ç—Ç–∏—Ö –¥–æ–º–µ–Ω–æ–≤ –≤—ã–ø—É—Å—Ç—è—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ 1-2 –º–∏–Ω—É—Ç.

---

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è cert-manager:** https://cert-manager.io/docs/
**Let's Encrypt:** https://letsencrypt.org/

