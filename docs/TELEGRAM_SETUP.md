# üîî –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

## –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:

‚úÖ **TelegramNotificationService** - —Å–µ—Ä–≤–∏—Å –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–∫–∞–∑–∞
‚úÖ **–¢–µ—Å—Ç–æ–≤—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç** –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞:

### 1. –°–æ–∑–¥–∞–π—Ç–µ Telegram –±–æ—Ç–∞

1. –ù–∞–π–¥–∏—Ç–µ **@BotFather** –≤ Telegram
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/newbot`
3. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –∏ –ø–æ–ª—É—á–∏—Ç–µ **BOT_TOKEN**

### 2. –ü–æ–ª—É—á–∏—Ç–µ Chat ID

1. –î–æ–±–∞–≤—å—Ç–µ –±–æ—Ç–∞ –≤ –≥—Ä—É–ø–ø—É –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –µ–º—É —Å–æ–æ–±—â–µ–Ω–∏–µ
2. –û—Ç–∫—Ä–æ–π—Ç–µ: `https://api.telegram.org/bot<YOUR_BOT_TOKEN>/getUpdates`
3. –ù–∞–π–¥–∏—Ç–µ `"chat":{"id":12345}` - —ç—Ç–æ –≤–∞—à **CHAT_ID**

### 3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
export TELEGRAM_BOT_TOKEN="your-bot-token-here"
export TELEGRAM_CHAT_ID="your-chat-id-here"
export TELEGRAM_ENABLED=true
```

–ò–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –≤ `integration-service/src/main/resources/application.yml`:

```yaml
telegram:
  bot:
    token: "YOUR_BOT_TOKEN"
    chat-id: "YOUR_CHAT_ID"
    enabled: true
```

### 4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Integration Service

```bash
pkill -f "integration-service.jar"
java -jar integration-service/build/libs/integration-service.jar &
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

### –¢–µ—Å—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:

```bash
curl -X POST http://localhost:8085/api/v1/integration/telegram/test
```

–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:
```json
{
  "success": true,
  "message": "Test message sent successfully"
}
```

### –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ–º:

```bash
curl -X POST http://localhost:8086/api/v1/orders \
  -H "Content-Type: application/json" \
  -d '{
    "organizationId": 1,
    "landingId": 1,
    "customerName": "–¢–µ—Å—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è",
    "customerPhone": "+79001112233",
    "items": [{"productId": 19, "quantity": 1}]
  }'
```

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞ –≤ Telegram –ø—Ä–∏–¥—ë—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ:
```
üõí –ù–û–í–´–ô –ó–ê–ö–ê–ó

üìã –ó–∞–∫–∞–∑ #7
üë§ –ö–ª–∏–µ–Ω—Ç: –¢–µ—Å—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
üìû –¢–µ–ª–µ—Ñ–æ–Ω: +79001112233

üí∞ –°—É–º–º–∞: 1500.0 —Ä—É–±

üì¶ –¢–æ–≤–∞—Ä—ã:
  ‚Ä¢ –°—Ç–æ–ª –æ—Ñ–∏—Å–Ω—ã–π "–õ–∏–¥–µ—Ä" √ó 1 = 1500.0 —Ä—É–±

üïê 03.11.2025 16:00
```

## API Endpoints:

### 1. –¢–µ—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
```
POST /api/v1/integration/telegram/test
```

### 2. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –∑–∞–∫–∞–∑–µ
```
POST /api/v1/integration/telegram/notify/order
Content-Type: application/json

{
  "orderId": 123,
  "customerName": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
  "customerPhone": "+79001234567",
  "totalAmount": 5000.0,
  "items": [...]
}
```

## –§–æ—Ä–º–∞—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:

```
üõí –ù–û–í–´–ô –ó–ê–ö–ê–ó

üìã –ó–∞–∫–∞–∑ #<ID>
üë§ –ö–ª–∏–µ–Ω—Ç: <–ò–º—è>
üìû –¢–µ–ª–µ—Ñ–æ–Ω: <–¢–µ–ª–µ—Ñ–æ–Ω>
‚úâÔ∏è Email: <Email> (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω)
üöö –ê–¥—Ä–µ—Å: <–ê–¥—Ä–µ—Å> (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω)

üí∞ –°—É–º–º–∞: <–°—É–º–º–∞> —Ä—É–±

üì¶ –¢–æ–≤–∞—Ä—ã:
  ‚Ä¢ <–ù–∞–∑–≤–∞–Ω–∏–µ> √ó <–ö–æ–ª-–≤–æ> = <–°—É–º–º–∞> —Ä—É–±
  ‚Ä¢ ...

üí¨ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: <–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π> (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω)

üïê <–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è>
```

## Troubleshooting:

### –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç?

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `telegram.bot.enabled=true`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å BOT_TOKEN
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å CHAT_ID
4. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–æ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –≤ –≥—Ä—É–ø–ø—É/—á–∞—Ç
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Integration Service:

```bash
tail -f logs/Integration-Service-TELEGRAM.log | grep -i telegram
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ "Unauthorized"?

- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π BOT_TOKEN
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–∫–µ–Ω –∏–∑ @BotFather

### –ü–æ–ª—É—á–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ "Chat not found"?

- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π CHAT_ID
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–æ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –≤ —á–∞—Ç
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Chat ID —á–µ—Ä–µ–∑ getUpdates

---

**–ì–æ—Ç–æ–≤–æ! –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –∏ —Ä–∞–±–æ—Ç–∞—é—Ç!** üéâ
