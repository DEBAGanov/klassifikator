<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="{{description}}">
    <title>{{title}}</title>
    <!-- CSS –±—É–¥–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω —Å–µ—Ä–≤–µ—Ä–æ–º -->
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Shopping Cart Button (Fixed) -->
    <button class="cart-button" onclick="toggleCart()" id="cartButton">
        <span class="cart-icon">üõí</span>
        <span class="cart-count" id="cartCount">0</span>
    </button>

    <!-- Shopping Cart Panel -->
    <div class="cart-panel" id="cartPanel">
        <div class="cart-header">
            <h3>–ö–æ—Ä–∑–∏–Ω–∞</h3>
            <button class="cart-close" onclick="toggleCart()">&times;</button>
        </div>
        <div class="cart-items" id="cartItems">
            <p class="cart-empty">–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</p>
        </div>
        <div class="cart-footer">
            <div class="cart-total">
                <span>–ò—Ç–æ–≥–æ:</span>
                <span id="cartTotal">0 ‚ÇΩ</span>
            </div>
            <button class="btn btn-primary" onclick="openOrderModal()" id="checkoutBtn" disabled>
                –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑
            </button>
        </div>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <h2>{{organizationName}}</h2>
                </div>
                <nav class="nav">
                    <a href="#about">–û –Ω–∞—Å</a>
                    <a href="#promotions">–ê–∫—Ü–∏–∏</a>
                    <a href="#products">–ö–∞—Ç–∞–ª–æ–≥</a>
                    <a href="#contacts">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a>
                </nav>
                <a href="tel:{{phone}}" class="header-phone">{{phone}}</a>
                <button class="mobile-menu-toggle" aria-label="–ú–µ–Ω—é">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
        </div>
    </header>

    <!-- Hero Slider Section -->
    {{#if companyPhotos}}
    <section class="hero-slider">
        <div class="slider-container">
            {{#each companyPhotos}}
            <div class="slide {{#if @first}}active{{/if}}">
                <img src="{{this}}" alt="{{../organizationName}}" class="slide-image">
                <div class="slide-overlay"></div>
            </div>
            {{/each}}
        </div>
        
        <div class="slider-content">
            <div class="container">
                <h1 class="slider-title">{{organizationName}}</h1>
                <p class="slider-description">{{description}}</p>
                <div class="slider-buttons">
                    <a href="#products" class="btn btn-primary">–ü–µ—Ä–µ–π—Ç–∏ –∫ –∫–∞—Ç–∞–ª–æ–≥—É</a>
                    <a href="#contacts" class="btn btn-secondary">–°–≤—è–∑–∞—Ç—å—Å—è —Å –Ω–∞–º–∏</a>
                </div>
            </div>
        </div>
        
        <!-- Slider Controls -->
        {{#if companyPhotos.[1]}}
        <button class="slider-control prev" onclick="changeSlide(-1)" aria-label="–ü—Ä–µ–¥—ã–¥—É—â–∏–π —Å–ª–∞–π–¥">
            <span>‚Äπ</span>
        </button>
        <button class="slider-control next" onclick="changeSlide(1)" aria-label="–°–ª–µ–¥—É—é—â–∏–π —Å–ª–∞–π–¥">
            <span>‚Ä∫</span>
        </button>
        
        <!-- Slider Indicators -->
        <div class="slider-indicators">
            {{#each companyPhotos}}
            <button class="indicator {{#if @first}}active{{/if}}" onclick="goToSlide({{@index}})" aria-label="–°–ª–∞–π–¥ {{@index}}"></button>
            {{/each}}
        </div>
        {{/if}}
    </section>
    {{else}}
    <!-- Fallback Hero Section (if no photos) -->
    <section class="hero">
        <div class="container">
            <div class="hero-content">
                <h1>{{organizationName}}</h1>
                <p class="hero-description">{{description}}</p>
                <div class="hero-buttons">
                    <a href="#products" class="btn btn-primary">–ü–µ—Ä–µ–π—Ç–∏ –∫ –∫–∞—Ç–∞–ª–æ–≥—É</a>
                    <a href="#contacts" class="btn btn-secondary">–°–≤—è–∑–∞—Ç—å—Å—è —Å –Ω–∞–º–∏</a>
                </div>
            </div>
        </div>
    </section>
    {{/if}}

    <!-- About Section -->
    {{#if aboutUs}}
    <section id="about" class="section about">
        <div class="container">
            <h2 class="section-title">–û –Ω–∞—Å</h2>
            <div class="about-content">
                <div class="about-text">
                    <p>{{aboutUs}}</p>
                </div>
            </div>
        </div>
    </section>
    {{/if}}

    <!-- Reviews Section (Yandex Reviews Widget) -->
    {{#if yandexReviewsWidget}}
    <section id="reviews" class="section reviews">
        <div class="container">
            <h2 class="section-title">–û—Ç–∑—ã–≤—ã –Ω–∞—à–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤</h2>
            <div class="reviews-widget">
                {{{yandexReviewsWidget}}}
            </div>
        </div>
    </section>
    {{/if}}

    <!-- Features Section -->
    {{#if features}}
    <section id="features" class="section features">
        <div class="container">
            <h2 class="section-title">–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏</h2>
            <div class="features-grid">
                {{#each features}}
                <div class="feature-card">
                    <div class="feature-icon">{{getFeatureIcon this}}</div>
                    <h3 class="feature-title">{{this}}</h3>
                </div>
                {{/each}}
            </div>
        </div>
    </section>
    {{/if}}

    <!-- Promotions Section -->
    {{#if promotions}}
    <section id="promotions" class="section promotions">
        <div class="container">
            <h2 class="section-title">–ê–∫—Ü–∏–∏ –∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è</h2>
            <div class="promotions-grid">
                {{#each promotions}}
                <div class="promotion-card">
                    {{#if imageUrl}}
                    <img src="{{imageUrl}}" alt="{{title}}" class="promotion-image" loading="lazy">
                    {{/if}}
                    <div class="promotion-content">
                        <h3>{{title}}</h3>
                        <p>{{description}}</p>
                        {{#if validTo}}
                        <p class="promotion-validity">–î–µ–π—Å—Ç–≤—É–µ—Ç –¥–æ: {{formatDate validTo}}</p>
                        {{/if}}
                    </div>
                </div>
                {{/each}}
            </div>
        </div>
    </section>
    {{/if}}

    <!-- Products Section -->
    {{#if products}}
    <section id="products" class="section products">
        <div class="container">
            <h2 class="section-title">–ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤</h2>
            
            <!-- Category Filters -->
            <div class="category-filters">
                <button class="category-filter active" data-category="all">–í—Å–µ</button>
                {{#each productCategories}}
                <button class="category-filter" data-category="{{this}}">{{this}}</button>
                {{/each}}
            </div>
            
            <!-- Products with images (Grid) -->
            <div class="products-grid">
                {{#each products}}
                {{#if imageUrl}}
                <div class="product-card" data-product-id="{{id}}" data-category="{{category}}">
                    <div class="product-image-container">
                        <img src="{{imageUrl}}" alt="{{name}}" class="product-image" loading="lazy">
                    </div>
                    <div class="product-content">
                        <h3 class="product-name">{{name}}</h3>
                        <p class="product-description">{{description}}</p>
                        {{#if category}}
                        <span class="product-category">{{category}}</span>
                        {{/if}}
                        {{#if price}}
                        <div class="product-footer">
                            <p class="product-price">{{formatPrice price}} ‚ÇΩ</p>
                            <button 
                                class="btn btn-primary btn-add-to-cart" 
                                onclick="addToCart({{id}}, '{{name}}', {{price}})"
                                data-product-id="{{id}}">
                                –í –∫–æ—Ä–∑–∏–Ω—É
                            </button>
                        </div>
                        {{/if}}
                    </div>
                </div>
                {{/if}}
                {{/each}}
            </div>
            
            <!-- Products without images (List) -->
            <div class="products-list">
                {{#each products}}
                {{#unless imageUrl}}
                <div class="product-list-item" data-product-id="{{id}}" data-category="{{category}}">
                    <div class="product-list-info">
                        <div class="product-list-header">
                            <h3 class="product-list-name">{{name}}</h3>
                            {{#if price}}
                            <p class="product-list-price">{{formatPrice price}} ‚ÇΩ</p>
                            {{/if}}
                        </div>
                        {{#if description}}
                        <p class="product-list-description">{{description}}</p>
                        {{/if}}
                    </div>
                    {{#if price}}
                    <button 
                        class="btn btn-primary btn-add-to-cart" 
                        onclick="addToCart({{id}}, '{{name}}', {{price}})"
                        data-product-id="{{id}}">
                        –í –∫–æ—Ä–∑–∏–Ω—É
                    </button>
                    {{/if}}
                </div>
                {{/unless}}
                {{/each}}
            </div>
        </div>
    </section>
    {{/if}}

    <!-- Reviews Section -->
    {{#if yandexReviewsWidget}}
    <section id="reviews" class="section reviews">
        <div class="container">
            <h2 class="section-title">–û—Ç–∑—ã–≤—ã –∫–ª–∏–µ–Ω—Ç–æ–≤</h2>
            <div class="reviews-widget">
                {{{yandexReviewsWidget}}}
            </div>
        </div>
    </section>
    {{/if}}

    <!-- Photos Gallery Section -->
    {{#if photos}}
    <section id="photos" class="section photos">
        <div class="container">
            <h2 class="section-title">–§–æ—Ç–æ–≥–∞–ª–µ—Ä–µ—è</h2>
            <div class="photos-grid">
                {{#each photos}}
                <div class="photo-item">
                    <img src="{{this}}" alt="–§–æ—Ç–æ {{@index}}" class="gallery-image" loading="lazy">
                </div>
                {{/each}}
            </div>
        </div>
    </section>
    {{/if}}

    <!-- Contacts Section -->
    <section id="contacts" class="section contacts">
        <div class="container">
            <h2 class="section-title">–ö–æ–Ω—Ç–∞–∫—Ç—ã</h2>
            <div class="contacts-content">
                <div class="contacts-info">
                    <div class="contact-item">
                        <h3>üìç –ê–¥—Ä–µ—Å</h3>
                        <p>{{address}}</p>
                    </div>
                    <div class="contact-item">
                        <h3>üìû –¢–µ–ª–µ—Ñ–æ–Ω</h3>
                        <p><a href="tel:{{phone}}">{{phone}}</a></p>
                    </div>
                    {{#if email}}
                    <div class="contact-item">
                        <h3>‚úâÔ∏è Email</h3>
                        <p><a href="mailto:{{email}}">{{email}}</a></p>
                    </div>
                    {{/if}}
                    <div class="contact-item">
                        <h3>üïê –†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã</h3>
                        <p>{{workingHours}}</p>
                    </div>
                </div>
                {{#if yandexMapWidget}}
                <div class="contacts-map">
                    {{{yandexMapWidget}}}
                </div>
                {{/if}}
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <p>&copy; 2025 {{organizationName}}. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
                <p>–°–æ–∑–¥–∞–Ω–æ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ <a href="https://klassifikator.ru" target="_blank">Klassifikator</a></p>
            </div>
        </div>
    </footer>

    <!-- Order Modal -->
    <div class="modal" id="orderModal">
        <div class="modal-overlay" onclick="closeOrderModal()"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h2>–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</h2>
                <button class="modal-close" onclick="closeOrderModal()">&times;</button>
            </div>
            
            <form id="orderForm" class="order-form">
                <!-- Order Items Summary -->
                <div class="order-items-summary" id="orderItemsSummary">
                    <!-- Will be populated by JS -->
                </div>

                <!-- Customer Details -->
                <div class="form-section">
                    <h3>–ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</h3>
                    <div class="form-group">
                        <label for="customerName">–ò–º—è *</label>
                        <input 
                            type="text" 
                            id="customerName" 
                            name="customerName" 
                            required
                            placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è">
                    </div>
                    
                    <div class="form-group">
                        <label for="customerPhone">–¢–µ–ª–µ—Ñ–æ–Ω *</label>
                        <input 
                            type="tel" 
                            id="customerPhone" 
                            name="customerPhone" 
                            required
                            placeholder="+7 (___) ___-__-__">
                    </div>
                    
                    <div class="form-group">
                        <label for="customerEmail">Email</label>
                        <input 
                            type="email" 
                            id="customerEmail" 
                            name="customerEmail"
                            placeholder="example@email.com">
                    </div>
                </div>

                <!-- Delivery Details -->
                <div class="form-section">
                    <h3>–î–æ—Å—Ç–∞–≤–∫–∞</h3>
                    <div class="form-group">
                        <label for="deliveryAddress">–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏</label>
                        <input 
                            type="text" 
                            id="deliveryAddress" 
                            name="deliveryAddress"
                            placeholder="–ì–æ—Ä–æ–¥, —É–ª–∏—Ü–∞, –¥–æ–º, –∫–≤–∞—Ä—Ç–∏—Ä–∞">
                    </div>
                    
                    <div class="form-group">
                        <label for="comment">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –∑–∞–∫–∞–∑—É</label>
                        <textarea 
                            id="comment" 
                            name="comment" 
                            rows="3"
                            placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è..."></textarea>
                    </div>
                </div>

                <!-- Order Total -->
                <div class="order-total">
                    <div class="total-row">
                        <span>–ò—Ç–æ–≥–æ:</span>
                        <span class="total-amount" id="orderTotalAmount">0 ‚ÇΩ</span>
                    </div>
                </div>

                <!-- Submit Button -->
                <button type="submit" class="btn btn-primary btn-large" id="submitOrderBtn">
                    –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑
                </button>

                <p class="form-note">* –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è</p>
            </form>
        </div>
    </div>

    <!-- Success Notification -->
    <div class="notification" id="notification">
        <div class="notification-content">
            <span class="notification-icon">‚úì</span>
            <span class="notification-message" id="notificationMessage"></span>
        </div>
    </div>

    <!-- Scripts -->
    <script>
        // Global configuration
        window.ORGANIZATION_ID = {{organizationId}};
        window.LANDING_ID = {{landingId}};
        // Auto-detect API URL based on environment
        window.API_URL = window.location.hostname.includes('volzhck.ru')
            ? 'https://api.volzhck.ru/api/v1'  // Production
            : 'http://localhost:8080/api/v1';  // Local development
    </script>
    <!-- JavaScript –±—É–¥–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω —Å–µ—Ä–≤–µ—Ä–æ–º -->
    <script src="order-form.js"></script>
    
    <!-- Yandex Metrika -->
    {{#if yandexMetrikaId}}
    <script type="text/javascript">
        (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
        (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");
        
        ym({{yandexMetrikaId}}, "init", {
            clickmap:true,
            trackLinks:true,
            accurateTrackBounce:true,
            ecommerce:"dataLayer"
        });
    </script>
    {{/if}}
</body>
</html>
